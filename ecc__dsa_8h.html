<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PSA Crypto: src/include/tinycrypt/ecc_dsa.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PSA Crypto
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_b0856f6b0d80ccb263b2f415c91f9e17.html">include</a></li><li class="navelem"><a class="el" href="dir_cb82b0834b2d4ad8b46d6782ee28b60e.html">tinycrypt</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ecc_dsa.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>&ndash; Interface to EC-DSA implementation.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="ecc_8h_source.html">ecc.h</a>&quot;</code><br />
</div>
<p><a href="ecc__dsa_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad1aedf4ecf6c2f802b0b4070c0412f60"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecc__dsa_8h.html#ad1aedf4ecf6c2f802b0b4070c0412f60">uECC_sign</a> (const uint8_t *p_private_key, const uint8_t *p_message_hash, unsigned p_hash_size, uint8_t *p_signature, <a class="el" href="structu_e_c_c___curve__t.html">uECC_Curve</a> curve)</td></tr>
<tr class="memdesc:ad1aedf4ecf6c2f802b0b4070c0412f60"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate an ECDSA signature for a given hash value.  <a href="ecc__dsa_8h.html#ad1aedf4ecf6c2f802b0b4070c0412f60">More...</a><br /></td></tr>
<tr class="separator:ad1aedf4ecf6c2f802b0b4070c0412f60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6d1fee4db80d9aeec4676eb4301de18"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecc__dsa_8h.html#af6d1fee4db80d9aeec4676eb4301de18">uECC_verify</a> (const uint8_t *p_public_key, const uint8_t *p_message_hash, unsigned int p_hash_size, const uint8_t *p_signature, <a class="el" href="structu_e_c_c___curve__t.html">uECC_Curve</a> curve)</td></tr>
<tr class="memdesc:af6d1fee4db80d9aeec4676eb4301de18"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verify an ECDSA signature.  <a href="ecc__dsa_8h.html#af6d1fee4db80d9aeec4676eb4301de18">More...</a><br /></td></tr>
<tr class="separator:af6d1fee4db80d9aeec4676eb4301de18"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>&ndash; Interface to EC-DSA implementation. </p>
<p>Overview: This software is an implementation of EC-DSA. This implementation uses curve NIST p-256.</p>
<p>Security: The curve NIST p-256 provides approximately 128 bits of security.</p>
<p>Usage: - To sign: Compute a hash of the data you wish to sign (SHA-2 is recommended) and pass it in to ecdsa_sign function along with your private key and a random number. You must use a new non-predictable random number to generate each new signature.</p><ul>
<li>To verify a signature: Compute the hash of the signed data using the same hash as the signer and pass it to this function along with the signer's public key and the signature values (r and s). </li>
</ul>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ad1aedf4ecf6c2f802b0b4070c0412f60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1aedf4ecf6c2f802b0b4070c0412f60">&#9670;&nbsp;</a></span>uECC_sign()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int uECC_sign </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>p_private_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>p_message_hash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>p_hash_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>p_signature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structu_e_c_c___curve__t.html">uECC_Curve</a>&#160;</td>
          <td class="paramname"><em>curve</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate an ECDSA signature for a given hash value. </p>
<dl class="section return"><dt>Returns</dt><dd>returns TC_CRYPTO_SUCCESS (1) if the signature generated successfully returns TC_CRYPTO_FAIL (0) if an error occurred.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p_private_key</td><td>IN &ndash; Your private key. </td></tr>
    <tr><td class="paramname">p_message_hash</td><td>IN &ndash; The hash of the message to sign. </td></tr>
    <tr><td class="paramname">p_hash_size</td><td>IN &ndash; The size of p_message_hash in bytes. </td></tr>
    <tr><td class="paramname">p_signature</td><td>OUT &ndash; Will be filled in with the signature value. Must be at least 2 * curve size long (for secp256r1, signature must be 64 bytes long).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>A cryptographically-secure PRNG function must be set (using uECC_set_rng()) before calling <a class="el" href="ecc__dsa_8h.html#ad1aedf4ecf6c2f802b0b4070c0412f60" title="Generate an ECDSA signature for a given hash value.">uECC_sign()</a>. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>Usage: Compute a hash of the data you wish to sign (SHA-2 is recommended) and pass it in to this function along with your private key. </dd>
<dd>
side-channel countermeasure: algorithm strengthened against timing attack. </dd></dl>

</div>
</div>
<a id="af6d1fee4db80d9aeec4676eb4301de18"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6d1fee4db80d9aeec4676eb4301de18">&#9670;&nbsp;</a></span>uECC_verify()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int uECC_verify </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>p_public_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>p_message_hash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>p_hash_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>p_signature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structu_e_c_c___curve__t.html">uECC_Curve</a>&#160;</td>
          <td class="paramname"><em>curve</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Verify an ECDSA signature. </p>
<dl class="section return"><dt>Returns</dt><dd>returns TC_SUCCESS (1) if the signature is valid returns TC_FAIL (0) if the signature is invalid.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p_public_key</td><td>IN &ndash; The signer's public key. </td></tr>
    <tr><td class="paramname">p_message_hash</td><td>IN &ndash; The hash of the signed data. </td></tr>
    <tr><td class="paramname">p_hash_size</td><td>IN &ndash; The size of p_message_hash in bytes. </td></tr>
    <tr><td class="paramname">p_signature</td><td>IN &ndash; The signature values.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Usage: Compute the hash of the signed data using the same hash as the signer and pass it to this function along with the signer's public key and the signature values (hash_size and signature). </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
