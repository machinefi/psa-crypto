<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PSA Crypto: iotex_ecp_group Struct Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PSA Crypto
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="structiotex__ecp__group-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">iotex_ecp_group Struct Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>The ECP group structure.  
 <a href="structiotex__ecp__group.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="ecp_8h_source.html">ecp.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a0f09e7896d6f282ca4038df7977fc380"><td class="memItemLeft" align="right" valign="top">iotex_ecp_group_id&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structiotex__ecp__group.html#a0f09e7896d6f282ca4038df7977fc380">id</a></td></tr>
<tr class="separator:a0f09e7896d6f282ca4038df7977fc380"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27b722b6554699d38513568de9c914f4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structiotex__mpi.html">iotex_mpi</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structiotex__ecp__group.html#a27b722b6554699d38513568de9c914f4">P</a></td></tr>
<tr class="separator:a27b722b6554699d38513568de9c914f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f5b1aaceef4343bd2a5e53c01baa10c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structiotex__mpi.html">iotex_mpi</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structiotex__ecp__group.html#a1f5b1aaceef4343bd2a5e53c01baa10c">A</a></td></tr>
<tr class="separator:a1f5b1aaceef4343bd2a5e53c01baa10c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17fc01fe262ffe3cf372691950a931cb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structiotex__mpi.html">iotex_mpi</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structiotex__ecp__group.html#a17fc01fe262ffe3cf372691950a931cb">B</a></td></tr>
<tr class="separator:a17fc01fe262ffe3cf372691950a931cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1819112b40ae1afb2515e1e0b055aec"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structiotex__ecp__point.html">iotex_ecp_point</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structiotex__ecp__group.html#aa1819112b40ae1afb2515e1e0b055aec">G</a></td></tr>
<tr class="separator:aa1819112b40ae1afb2515e1e0b055aec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a613a7d3a445382306d85a3db64ff23be"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structiotex__mpi.html">iotex_mpi</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structiotex__ecp__group.html#a613a7d3a445382306d85a3db64ff23be">N</a></td></tr>
<tr class="separator:a613a7d3a445382306d85a3db64ff23be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba1fcd0101a0447c4193ce0feca04460"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structiotex__ecp__group.html#aba1fcd0101a0447c4193ce0feca04460">pbits</a></td></tr>
<tr class="separator:aba1fcd0101a0447c4193ce0feca04460"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add94a6e9abd7f7bc368791a698a928c9"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structiotex__ecp__group.html#add94a6e9abd7f7bc368791a698a928c9">nbits</a></td></tr>
<tr class="separator:add94a6e9abd7f7bc368791a698a928c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e8e4643187074c2c3a4d692018757d7"><td class="memItemLeft" align="right" valign="top"><a id="a5e8e4643187074c2c3a4d692018757d7"></a>
unsigned int&#160;</td><td class="memItemRight" valign="bottom"><b>h</b></td></tr>
<tr class="separator:a5e8e4643187074c2c3a4d692018757d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54008d018fc014c58a4d967541df8695"><td class="memItemLeft" align="right" valign="top">int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structiotex__ecp__group.html#a54008d018fc014c58a4d967541df8695">modp</a> )(<a class="el" href="structiotex__mpi.html">iotex_mpi</a> *)</td></tr>
<tr class="separator:a54008d018fc014c58a4d967541df8695"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe1ecf97d93763a33766cf15dbd1e361"><td class="memItemLeft" align="right" valign="top">int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structiotex__ecp__group.html#afe1ecf97d93763a33766cf15dbd1e361">t_pre</a> )(<a class="el" href="structiotex__ecp__point.html">iotex_ecp_point</a> *, void *)</td></tr>
<tr class="separator:afe1ecf97d93763a33766cf15dbd1e361"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9b592e905ec5e5fd9b922979ac1b3c2"><td class="memItemLeft" align="right" valign="top">int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structiotex__ecp__group.html#ab9b592e905ec5e5fd9b922979ac1b3c2">t_post</a> )(<a class="el" href="structiotex__ecp__point.html">iotex_ecp_point</a> *, void *)</td></tr>
<tr class="separator:ab9b592e905ec5e5fd9b922979ac1b3c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cc35bf852ec15a852951eb95d1b9e48"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structiotex__ecp__group.html#a6cc35bf852ec15a852951eb95d1b9e48">t_data</a></td></tr>
<tr class="separator:a6cc35bf852ec15a852951eb95d1b9e48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0709e8a2f14ddcc2f6519a9e7a85fcf4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structiotex__ecp__point.html">iotex_ecp_point</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structiotex__ecp__group.html#a0709e8a2f14ddcc2f6519a9e7a85fcf4">T</a></td></tr>
<tr class="separator:a0709e8a2f14ddcc2f6519a9e7a85fcf4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0447426450d5030848d4d092fb393638"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structiotex__ecp__group.html#a0447426450d5030848d4d092fb393638">T_size</a></td></tr>
<tr class="separator:a0447426450d5030848d4d092fb393638"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The ECP group structure. </p>
<p>We consider two types of curve equations: </p><ul>
<li>
Short Weierstrass: <code>y^2 = x^3 + A x + B mod P</code> (SEC1 + RFC-4492) </li>
<li>
Montgomery: <code>y^2 = x^3 + A x^2 + x mod P</code> (Curve25519, Curve448)</li>
</ul>
<p>In both cases, the generator (<code>G</code>) for a prime-order subgroup is fixed.</p>
<p>For Short Weierstrass, this subgroup is the whole curve, and its cardinality is denoted by <code>N</code>. Our code requires that <code>N</code> is an odd prime as iotex_ecp_mul() requires an odd number, and iotex_ecdsa_sign() requires that it is prime for blinding purposes.</p>
<p>For Montgomery curves, we do not store <code>A</code>, but <code>(A + 2) / 4</code>, which is the quantity used in the formulas. Additionally, <code>nbits</code> is not the size of <code>N</code> but the required size for private keys.</p>
<p>If <code>modp</code> is NULL, reduction modulo <code>P</code> is done using a generic algorithm. Otherwise, <code>modp</code> must point to a function that takes an <code><a class="el" href="structiotex__mpi.html" title="MPI structure.">iotex_mpi</a></code> in the range of <code>0..2^(2*pbits)-1</code>, and transforms it in-place to an integer which is congruent mod <code>P</code> to the given MPI, and is close enough to <code>pbits</code> in size, so that it may be efficiently brought in the 0..P-1 range by a few additions or subtractions. Therefore, it is only an approximative modular reduction. It must return 0 on success and non-zero on failure.</p>
<dl class="section note"><dt>Note</dt><dd>Alternative implementations of the ECP module must obey the following constraints.<ul>
<li>Group IDs must be distinct: if two group structures have the same ID, then they must be identical.</li>
<li>The fields <code>id</code>, <code>P</code>, <code>A</code>, <code>B</code>, <code>G</code>, <code>N</code>, <code>pbits</code> and <code>nbits</code> must have the same type and semantics as in the built-in implementation. They must be available for reading, but direct modification of these fields does not need to be supported. They do not need to be at the same offset in the structure. </li>
</ul>
</dd></dl>
</div><h2 class="groupheader">Member Data Documentation</h2>
<a id="a1f5b1aaceef4343bd2a5e53c01baa10c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f5b1aaceef4343bd2a5e53c01baa10c">&#9670;&nbsp;</a></span>A</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structiotex__mpi.html">iotex_mpi</a> iotex_ecp_group::A</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>For Short Weierstrass: <code>A</code> in the equation. For Montgomery curves: <code>(A + 2) / 4</code>. </p>

</div>
</div>
<a id="a17fc01fe262ffe3cf372691950a931cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17fc01fe262ffe3cf372691950a931cb">&#9670;&nbsp;</a></span>B</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structiotex__mpi.html">iotex_mpi</a> iotex_ecp_group::B</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>For Short Weierstrass: <code>B</code> in the equation. For Montgomery curves: unused. </p>

</div>
</div>
<a id="aa1819112b40ae1afb2515e1e0b055aec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1819112b40ae1afb2515e1e0b055aec">&#9670;&nbsp;</a></span>G</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structiotex__ecp__point.html">iotex_ecp_point</a> iotex_ecp_group::G</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The generator of the subgroup used. </p>

</div>
</div>
<a id="a0f09e7896d6f282ca4038df7977fc380"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f09e7896d6f282ca4038df7977fc380">&#9670;&nbsp;</a></span>id</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">iotex_ecp_group_id iotex_ecp_group::id</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>An internal group identifier. </p>

</div>
</div>
<a id="a54008d018fc014c58a4d967541df8695"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54008d018fc014c58a4d967541df8695">&#9670;&nbsp;</a></span>modp</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int(* iotex_ecp_group::modp) (<a class="el" href="structiotex__mpi.html">iotex_mpi</a> *)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The function for fast pseudo-reduction mod <code>P</code> (see above). </p>

</div>
</div>
<a id="a613a7d3a445382306d85a3db64ff23be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a613a7d3a445382306d85a3db64ff23be">&#9670;&nbsp;</a></span>N</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structiotex__mpi.html">iotex_mpi</a> iotex_ecp_group::N</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The order of <code>G</code>. </p>

</div>
</div>
<a id="add94a6e9abd7f7bc368791a698a928c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add94a6e9abd7f7bc368791a698a928c9">&#9670;&nbsp;</a></span>nbits</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t iotex_ecp_group::nbits</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>For Short Weierstrass: The number of bits in <code>P</code>. For Montgomery curves: the number of bits in the private keys. </p>

</div>
</div>
<a id="a27b722b6554699d38513568de9c914f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27b722b6554699d38513568de9c914f4">&#9670;&nbsp;</a></span>P</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structiotex__mpi.html">iotex_mpi</a> iotex_ecp_group::P</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The prime modulus of the base field. </p>

</div>
</div>
<a id="aba1fcd0101a0447c4193ce0feca04460"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba1fcd0101a0447c4193ce0feca04460">&#9670;&nbsp;</a></span>pbits</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t iotex_ecp_group::pbits</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The number of bits in <code>P</code>. </p>

</div>
</div>
<a id="a0709e8a2f14ddcc2f6519a9e7a85fcf4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0709e8a2f14ddcc2f6519a9e7a85fcf4">&#9670;&nbsp;</a></span>T</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structiotex__ecp__point.html">iotex_ecp_point</a>* iotex_ecp_group::T</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Pre-computed points for ecp_mul_comb(). </p>

</div>
</div>
<a id="a6cc35bf852ec15a852951eb95d1b9e48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cc35bf852ec15a852951eb95d1b9e48">&#9670;&nbsp;</a></span>t_data</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* iotex_ecp_group::t_data</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Unused. </p>

</div>
</div>
<a id="ab9b592e905ec5e5fd9b922979ac1b3c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9b592e905ec5e5fd9b922979ac1b3c2">&#9670;&nbsp;</a></span>t_post</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int(* iotex_ecp_group::t_post) (<a class="el" href="structiotex__ecp__point.html">iotex_ecp_point</a> *, void *)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Unused. </p>

</div>
</div>
<a id="afe1ecf97d93763a33766cf15dbd1e361"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe1ecf97d93763a33766cf15dbd1e361">&#9670;&nbsp;</a></span>t_pre</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int(* iotex_ecp_group::t_pre) (<a class="el" href="structiotex__ecp__point.html">iotex_ecp_point</a> *, void *)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Unused. </p>

</div>
</div>
<a id="a0447426450d5030848d4d092fb393638"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0447426450d5030848d4d092fb393638">&#9670;&nbsp;</a></span>T_size</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t iotex_ecp_group::T_size</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The number of dynamic allocated pre-computed points. </p>

</div>
</div>
<hr/>The documentation for this struct was generated from the following file:<ul>
<li>src/include/iotex/<a class="el" href="ecp_8h_source.html">ecp.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
